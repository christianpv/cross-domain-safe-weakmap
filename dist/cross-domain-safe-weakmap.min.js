!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("xdsweakmap",[],t):"object"==typeof exports?exports.xdsweakmap=t():e.xdsweakmap=t()}(this,function(){return function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=a(n);t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2);Object.defineProperty(t,"WeakMap",{enumerable:!0,get:function(){return a.WeakMap}})},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.WeakMap=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(3),s=r(4),o=Object.defineProperty,u=Date.now()%1e9;t.WeakMap=function(){function e(){if(a(this,e),u+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+u,(0,s.hasNativeWeakMap)())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return n(e,[{key:"_cleanupClosedWindows",value:function(){for(var e=this.weakmap,t=this.keys,r=0;r<t.length;r++){var a=t[r];if((0,i.isClosedWindow)(a)){if(e)try{e.delete(a)}catch(e){}t.splice(r,1),this.values.splice(r,1),r-=1}}}},{key:"set",value:function(e,t){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.set(e,t)}catch(e){delete this.weakmap}if((0,i.isWindow)(e)){this._cleanupClosedWindows();var a=this.keys,n=this.values,s=a.indexOf(e);s===-1?(a.push(e),n.push(t)):n[s]=t}else{var u=this.name,c=e[u];c&&c[0]===e?c[1]=t:o(e,u,{value:[e,t],writable:!0})}}},{key:"get",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(e))return t.get(e)}catch(e){delete this.weakmap}if((0,i.isWindow)(e)){var r=this.keys,a=r.indexOf(e);if(a===-1)return;return this.values[a]}var n=e[this.name];if(n&&n[0]===e)return n[1]}},{key:"delete",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.delete(e)}catch(e){delete this.weakmap}if((0,i.isWindow)(e)){this._cleanupClosedWindows();var r=this.keys,a=r.indexOf(e);a!==-1&&(r.splice(a,1),this.values.splice(a,1))}else{var n=e[this.name];n&&n[0]===e&&(n[0]=n[1]=void 0)}}},{key:"has",value:function(e){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{return t.has(e)}catch(e){delete this.weakmap}if((0,i.isWindow)(e))return this._cleanupClosedWindows(),this.keys.indexOf(e)!==-1;var r=e[this.name];return!(!r||r[0]!==e)}}]),e}()},function(e,t){"use strict";function r(e){try{if(e&&e.self===e)return!0}catch(e){}return!1}function a(e){try{if(e&&e!==window&&e.closed)return!0}catch(e){return!e||"Call was rejected by callee.\r\n"!==e.message}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.isWindow=r,t.isClosedWindow=a},function(e,t){"use strict";function r(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,t={},r="__testvalue__";return window.Object.freeze(t),e.set(t,r),e.get(t)===r}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.hasNativeWeakMap=r}])});
//# sourceMappingURL=cross-domain-safe-weakmap.min.js.map